# dcgan_struct
This example showed how to generate a neural network and implement the training flow. In this example, the target is to train a GAN (Generative Adversarial Network) to generate fake MNIST images. If you want to get more details about this example, you see [this](https://pytorch.org/tutorials/advanced/cpp_frontend.html#defining-the-dcgan-modules).

## Usage
This example is complete program. You can run this example to train GAN. 

First, you must download [MNIST dataset](http://yann.lecun.com/exdb/mnist/). You can run these command to get the training dataset:
```bash
mkdir dataset
cd dataset
wget http://yann.lecun.com/exdb/mnist/train-images-idx3-ubyte.gz
wget http://yann.lecun.com/exdb/mnist/train-labels-idx1-ubyte.gz
gzip -d train-images-idx3-ubyte.gz
gzip -d train-labels-idx1-ubyte.gz
```

Second, you can build this example:
```bash
make clean
make
```

The executable file will exist in the directory `bin`. And then you can run this example to train model with default configuration.
```
./bin/dcgan_struct/dcgan_strct
```

This example offers arguments to set config.

| Arg   | Default value | Description   |
|:-----:|:-------------:|---------------|
| `-n`  | 100           | Set the size of noise vector fed to the GAN. |
| `-b`  | 64            | Set the batch size for training model. |
| `-e`  | 30            | Set the number of epoches for training model. |
| `-m`  | `./models`    | Set the directory to save the models. |
| `-d`  | `./dataset`   | Set the directory to find the MNISt dataset. |
| `-c`  | 200           | Set it to how many epoches to save checkpoint. |
| `-r`  | 0             | Set to positive integer to resume previous checkpoint. |
| `-s`  | 10            | Set to how many saves sample images that are generated by GAN at every checkpoint.|
| `-l`  | 10            | Set to log a new update with the loss value. |
| `-v`  | -1            | Set to `-1`, and then this example will train model on CPU. If you want to train model on GPU, you must set to a non-negative integer that is the index of GPUs. |
| `-h`  |               | Show the usage of this example. |

If you run this example without any arguments, this example will train model on CPU. You can run this command to train model on GPU:
```bash
./bin/dcgan_struct/dcgan_struct -v 0
```